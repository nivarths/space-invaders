// Font.cpp
#include "Font.h"

// 8Ã—8 bitmaps for the characters we need:

static const uint8_t F_A[8] = {0x18,0x24,0x42,0x7E,0x42,0x42,0x42,0x00};
static const uint8_t F_C[8] = {0x1E,0x21,0x20,0x20,0x20,0x21,0x1E,0x00};
static const uint8_t F_D[8] = {0x7C,0x42,0x41,0x41,0x41,0x42,0x7C,0x00};
static const uint8_t F_E[8] = {0x7E,0x40,0x40,0x7C,0x40,0x40,0x7E,0x00};
static const uint8_t F_G[8] = {0x1E,0x21,0x20,0x2E,0x21,0x21,0x1E,0x00};
static const uint8_t F_I[8] = {0x7E,0x18,0x18,0x18,0x18,0x18,0x7E,0x00};
static const uint8_t F_L[8] = {0x40,0x40,0x40,0x40,0x40,0x40,0x7E,0x00};
static const uint8_t F_M[8] = {0x42,0x66,0x5A,0x5A,0x42,0x42,0x42,0x00};
static const uint8_t F_N[8] = {0x42,0x62,0x52,0x4A,0x46,0x42,0x42,0x00};
static const uint8_t F_O[8] = {0x3C,0x42,0x42,0x42,0x42,0x42,0x3C,0x00};
static const uint8_t F_P[8] = {0x7C,0x42,0x42,0x7C,0x40,0x40,0x40,0x00};
static const uint8_t F_R[8] = {0x7C,0x42,0x42,0x7C,0x48,0x44,0x42,0x00};
static const uint8_t F_S[8] = {0x3C,0x42,0x30,0x1C,0x06,0x42,0x3C,0x00};
static const uint8_t F_T[8] = {0x7E,0x18,0x18,0x18,0x18,0x18,0x18,0x00};
static const uint8_t F_U[8] = {0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00};
static const uint8_t F_V[8] = {0x42,0x42,0x42,0x42,0x42,0x24,0x18,0x00};

// Digits (unchanged)
static const uint8_t D0[8] = {0x3C,0x66,0x6E,0x7E,0x76,0x66,0x3C,0x00};
static const uint8_t D1[8] = {0x18,0x38,0x18,0x18,0x18,0x18,0x3C,0x00};
static const uint8_t D2[8] = {0x3C,0x66,0x06,0x0C,0x18,0x30,0x7E,0x00};
static const uint8_t D3[8] = {0x3C,0x66,0x06,0x1C,0x06,0x66,0x3C,0x00};
static const uint8_t D4[8] = {0x0C,0x1C,0x2C,0x4C,0x7E,0x0C,0x0C,0x00};
static const uint8_t D5[8] = {0x7E,0x60,0x7C,0x06,0x06,0x66,0x3C,0x00};
static const uint8_t D6[8] = {0x3C,0x60,0x7C,0x66,0x66,0x66,0x3C,0x00};
static const uint8_t D7[8] = {0x7E,0x06,0x0C,0x18,0x30,0x30,0x30,0x00};
static const uint8_t D8[8] = {0x3C,0x66,0x3C,0x66,0x66,0x66,0x3C,0x00};
static const uint8_t D9[8] = {0x3C,0x66,0x66,0x3E,0x06,0x0C,0x38,0x00};

std::unordered_map<char,Sprite> createGameFont()
{
    std::unordered_map<char,Sprite> m;

    struct Def { char ch; const uint8_t* bits; };
    static constexpr Def defs[] = {
      // letters
      {'A',F_A},{'C',F_C},{'D',F_D},{'E',F_E},{'G',F_G},
      {'I',F_I},{'L',F_L},{'M',F_M},{'N',F_N},{'O',F_O},
      {'P',F_P},{'R',F_R},{'S',F_S},{'T',F_T},{'U',F_U},
      {'V',F_V},
      // digits
      {'0',D0},{'1',D1},{'2',D2},{'3',D3},{'4',D4},
      {'5',D5},{'6',D6},{'7',D7},{'8',D8},{'9',D9},
    };

    for (auto &def : defs) {
      Sprite glyph(8,8);
      for (int row = 0; row < 8; ++row) {
        uint8_t mask = def.bits[row];
        for (int col = 0; col < 8; ++col) {
          if ((mask >> (7 - col)) & 1) {
            glyph.setPixel(col, row, 1);
          }
        }
      }
      m.emplace(def.ch, std::move(glyph));
    }

    return m;
}
